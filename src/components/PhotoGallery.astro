---
import { getCollection } from "astro:content";

const posts = (await getCollection("photo-gallery")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);



const eventTypes = ["Open Mics", "Studio Sessions (On Campus)", "General Member Socials", "Studio Sessions (Off Campus)"];
  const groupedPosts = eventTypes.map(eventType => ({
    eventType,
    posts: posts.filter(post => post.data.type === eventType),
  }));

---

<!doctype html>
<html lang="en">
  <head>
    <style>
      main {
        width: 100%;
      }
      ul {
        display: flex;
        flex-wrap: wrap;
        gap: 2rem;
        list-style-type: none;
        margin: 0;
        padding: 0;
        width: 100%;
        align-items: center;
        justify-content: center;
        padding-left: 5vw;
        padding-right: 5vw;
      }
      ul li {
        width: calc(50% - 1rem);
        margin-bottom: 1rem;
      }
      ul li * {
        text-decoration: none;
        transition: 0.2s ease;
      }
      ul li img {
        margin-bottom: 1rem;
        border-radius: 0px;
        &:hover {
        }
      }
      ul li a {
        display: block;
      }
      .title {
        margin: 0;
        color: rgb(255, 255, 255);
        line-height: 1;
      }
      .date {
        margin: 0;
        color: rgb(255, 56, 56);
      }
      ul li a:hover .title {
        color: rgb(255, 56, 56);
      }
      ul li a:hover .date {
        color: rgb(255, 255, 255);
      }
      ul iframe {
        margin-top: 1rem;
      }
      ul iframe:hover {
        box-shadow: 0px 0px 0px 5px rgb(255, 255, 255);
      }
      @media (max-width: 720px) {
        ul {
          gap: 0.5em;
        }
        ul li {
          width: 100%;
          text-align: center;
          margin-left: 10vw;
          margin-right: 10vw;
        }
      }
    </style>
  </head>
  <body class="bg-black">
    <h1>Gallery</h1>
    <main class="mt-10 border-b">
      {groupedPosts.map(({ eventType, posts }) => (
        <section>
          <h2>{eventType}</h2>
          <ul>
            {posts.map((post) => (
              <li>
                <img src={post.data.imgSrc} alt={post.data.description} />
              </li>
            ))}
          </ul>
        </section>
      ))}
    </main>
  </body>
</html>
